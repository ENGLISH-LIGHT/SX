var musicModels=[],player=new Player;function Player(){this.audio=document.getElementById("myaudio"),this.playIndex=0,this.audio.loop=!1,this.audio.addEventListener("ended",function(){player.next()},!1),this.playMusic=function(){$(this.audio).attr("src",musicModels[this.playIndex].src),this.audio.play(),$(".pic img").attr("src",musicModels[this.playIndex].img),this.rangeUp()},this.playPause=function(){var a=document.querySelector(".pause img");this.audio.paused?(this.audio.play(),a.src="../img/stop.png",$(".pic img").css("animation-play-state","running")):(this.audio.pause(),a.src="../img/play.png",$(".pic img").css("animation-play-state","paused"))},this.rangeUp=function(){this.audio.ontimeupdate=function(){$("#range").attr("max",this.duration).val(this.currentTime)}},this.next=function(){player.playIndex++,player.playIndex>musicModels.length-1&&(player.playIndex=0),player.playMusic(),$(`.musicbox div:nth-child(${player.playIndex+1})`).addClass("playBg").siblings().removeClass("playBg")},this.prev=function(){player.playIndex--,player.playIndex<0&&(player.playIndex=musicModels.length-1),player.playMusic(),$(`.musicbox div:nth-child(${player.playIndex+1})`).addClass("playBg").siblings().removeClass("playBg")}}function getData(){$.getJSON("../pbl.json",function(a){for(var i=0;i<a.length;i++){var s=new Music(a[i].img,a[i].musicName,a[i].name,a[i].num,a[i].src);musicModels.push(s)}inserData(),player.playMusic()})}function inserData(){for(var a=0;a<musicModels.length;a++){var i=`<div class='music' data-index=${a}><img src='${musicModels[a].img}'/><p>${musicModels[a].musicName}——${musicModels[a].name}</p></div>`;$(".page .musicbox").append(i),0===a&&$(".page .musicbox div:first-child").addClass("playBg").siblings().removeClass("playBg"),$(".page .musicbox div").click(function(){player.playIndex=$(this).data("index"),player.playMusic(),$(this).addClass("playBg").siblings().removeClass("playBg")})}}function Music(a,i,s,e,l){this.img=a,this.musicName=i,this.name=s,this.num=e,this.src=l}getData(),$(".prev").click(player.prev),$(".next").click(player.next),$(".pause").click(function(){player.playPause()});